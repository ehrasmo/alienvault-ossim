# AlienVault Snort Rules
#
# SIDs range: 4000000-4999999
#
# DO NOT EDIT THIS FILE. It will be overwritten by the AlienVault VRT in the updates. 
#
# To include your own rules, assign a sid between 5000000-5999999
# and add it to local.rules and run:
#
# perl /usr/share/ossim/scripts/create_sidmap.pl /etc/suricata/rules/
# and restart suricata: /etc/init.d/suricata restart

# Thresholds
event_filter \
    gen_id 1, sig_id 4000001, \
    type limit, track by_src, \
    count 1, seconds 360 
event_filter \
    gen_id 1, sig_id 4000002, \
    type limit, track by_src, \
    count 1, seconds 360
event_filter \
    gen_id 1, sig_id 4000003, \
    type limit, track by_src, \
    count 1, seconds 360
event_filter \
    gen_id 1, sig_id 4000004, \
    type limit, track by_src, \
    count 1, seconds 360
event_filter \
    gen_id 1, sig_id 4000005, \
    type limit, track by_src, \
    count 1, seconds 360
  
# Cleartext passwords
alert tcp any any -> $HOME_NET [20,21] (msg:"AV-RULES FTP password detected in cleartext"; flow:established,to_server; content:"|50 41 53 53|"; content:!"example.com"; content:!"apt_get"; content:!"root@arch"; classtype:policy-violation; sid:4000001; rev:1;)
alert tcp $HOME_NET 23 -> any any (msg:"AV-RULES Telnet password detected in cleartext"; flow:established,from_server; content:"|50 61 73 73 77 6f 72 64 3a|"; classtype:policy-violation; sid:4000002; rev:1;)
alert tcp $HOME_NET 110 -> any any (msg:"AV-RULES POP3 password detected in cleartext"; flow:established,from_server; content:"|2b 4f 4b 20 4c 6f 67 67 65 64 20 69 6e 2e|"; classtype:policy-violation; sid:4000003; rev:1;)
alert tcp $HOME_NET 143 -> any any (msg:"AV-RULES IMAP password detected in cleartext"; flow:established,from_server; content:"|4c 6f 67 67 65 64 20 69 6e|"; classtype:policy-violation; sid:4000004; rev:1;)
alert tcp $HOME_NET 25 -> any any (msg:"AV-RULES SMTP password detected in cleartext"; flow:established,from_server; content:"|41 75 74 68 65 6e 74 69 63 61 74 69 6f 6e 20 73 75 63 63 65 73 73 66 75 6c|"; classtype:policy-violation; sid:4000005; rev:1;)
